setwd("/home/fsouto/ntnu/2024_spring/IT3010_metod/assignments/a2")

# Load required libraries
library(haven)
library(dplyr)

# Read the CSV data file
data <- read.csv("quest_data.csv")

# Recode fieldOfStudy to create two groups: "exact sciences" and "others"
data$group <- ifelse(data$fieldOfStudy %in% c("math", "infoTech", "engineering", "bioMedic"), "Exact Sciences", "Others")

# Make sure the group variable is a factor with only two levels
data$group <- factor(data$group, levels = c("Exact Sciences", "Others"))

# Filter data for exact science students
exact_science_data <- subset(data, group == "Exact Sciences")

# Filter data for other students
other_students_data <- subset(data, group == "Others")

# Calculate awareness score for exact science students
exact_science_data$awareness_score <- rowSums(subset(exact_science_data, select = c(likelyCollectedData.camera, likelyCollectedData.gps, likelyCollectedData.mobileNum, likelyCollectedData.searches, likelyCollectedData.myData, likelyCollectedData.name, likelyCollectedData.address, likelyCollectedData.shoeSize, likelyCollectedData.mobileDeviceType, likelyCollectedData.movementData, likelyCollectedData.choices, likelyCollectedData.eMail, likelyCollectedData.video, likelyCollectedData.paymentHistory, likelyCollectedData.contacts, likelyCollectedData.thirdPartiesActivity)))

# Calculate awareness score for other students
other_students_data$awareness_score <- rowSums(subset(other_students_data, select = c(likelyCollectedData.camera, likelyCollectedData.gps, likelyCollectedData.mobileNum, likelyCollectedData.searches, likelyCollectedData.myData, likelyCollectedData.name, likelyCollectedData.address, likelyCollectedData.shoeSize, likelyCollectedData.mobileDeviceType, likelyCollectedData.movementData, likelyCollectedData.choices, likelyCollectedData.eMail, likelyCollectedData.video, likelyCollectedData.paymentHistory, likelyCollectedData.contacts, likelyCollectedData.thirdPartiesActivity)))

# Calculate awareness score for all students
data$awareness_score <- rowSums(subset(data, select = c(likelyCollectedData.camera, likelyCollectedData.gps, likelyCollectedData.mobileNum, likelyCollectedData.searches, likelyCollectedData.myData, likelyCollectedData.name, likelyCollectedData.address, likelyCollectedData.shoeSize, likelyCollectedData.mobileDeviceType, likelyCollectedData.movementData, likelyCollectedData.choices, likelyCollectedData.eMail, likelyCollectedData.video, likelyCollectedData.paymentHistory, likelyCollectedData.contacts, likelyCollectedData.thirdPartiesActivity)))


# Perform t-test comparing awareness scores between exact science students and others
t_test_result <- t.test(awareness_score ~ group, 
                        data = rbind(exact_science_data, other_students_data))

# Print t-test result
print(t_test_result)

# Perform ANOVA to compare awareness scores between "exact sciences" and "others"
anova_result <- aov(awareness_score ~ group, data = data)

# Print ANOVA result
print(summary(anova_result))

# Create boxplot to visualize awareness scores between "exact sciences" and "others"
boxplot(awareness_score ~ group, data = data,
        xlab = "Field of Study", ylab = "Awareness Score",
        main = "Awareness Score Between Exact Sciences and Others")
